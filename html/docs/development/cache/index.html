<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  
<title>Cache - NoFussFramework Documentation</title>  
<link rel="shortcut icon" href="../../img/favicon.ico">
 
<link
	href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700'
	rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="../../css/theme.css"
	type="text/css" />
<link rel="stylesheet" href="../../css/theme_extra.css"
	type="text/css" />
<link rel="stylesheet" href="../../css/highlight.css"> 
<script>
	// Current page data
	var mkdocs_page_name = "Cache";
	var mkdocs_page_url = "/development/cache/";
</script>

<script src="../../js/jquery-2.1.1.min.js"></script>
<script src="../../js/modernizr-2.8.3.min.js"></script>
<script type="text/javascript" src="../../js/highlight.pack.js"></script>
<script src="../../js/theme.js"></script>  
<script>
	(function(i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r;
		i[r] = i[r] || function() {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date();
		a = s.createElement(o), m = s.getElementsByTagName(o)[0];
		a.async = 1;
		a.src = g;
		m.parentNode.insertBefore(a, m)
	})(window, document, 'script', '//www.google-analytics.com/analytics.js',
			'ga');

	ga('create', 'UA-30907299-4', 'auto');
	ga('send', 'pageview');
</script>

</head>

<body class="wy-body-for-nav" role="document">

	<header>
		<a class="logo" href="/">NoFussFramework</a>
		<ul>
			<li><a href="/docs/">Documentation</a></li>
			<li><a href="/download/">Download</a></li>
			<li><a href="/community/">Community</a></li>
		</ul>
	</header>
	<div class="wy-grid-for-nav">

		
		<nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
			<div class="wy-side-nav-search"><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
			</div>

			<div class="wy-menu wy-menu-vertical" data-spy="affix"
				role="navigation" aria-label="main navigation">
				<ul class="current">
					
					<li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Documentation Home</a>
        
    </li>

					<li>
					<li>
    <li class="toctree-l1 ">
        <a class="" href="../../intro/introduction/">Introduction</a>
        
    </li>

					<li>
					<li>
    <li class="toctree-l1 ">
        <a class="" href="../../setup/try-it-now/">Try it now</a>
        
    </li>

					<li>
					<li>
    <ul class="subnav">
    <li><span>Getting started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../setup/requirements/">Requirements</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../setup/installation/">Installation</a>
        
    </li>

        
    </ul>

					<li>
					<li>
    <ul class="subnav">
    <li><span>Configuration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/introduction/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/overview/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/config.ini/">config.ini - app settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/config.ini-optional/">config.ini - optional settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/config.ini-more/">config.ini - going further</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/url.ini/">url.ini</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../configuration/routes/">routes</a>
        
    </li>

        
    </ul>

					<li>
					<li>
    <ul class="subnav">
    <li><span>Development</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../bootstrap/">Bootstrap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../controllers/">Controllers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../models/">Models</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../views/">Views</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../helpers/">Helpers: Settings, Config, Env, Registry, etc</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../db/">Database queries</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../input-data/">Getting input</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../input-filtering/">Input filtering</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Cache</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#different-cache-systems">Different cache systems</a></li>
                
                    <li><a class="toctree-l4" href="#memcached">Memcached</a></li>
                
                    <li><a class="toctree-l4" href="#apcapcu">apc/apcu</a></li>
                
            
                <li class="toctree-l3"><a href="#common-parameters">Common parameters</a></li>
                
                    <li><a class="toctree-l4" href="#keys-prefix">Keys prefix</a></li>
                
                    <li><a class="toctree-l4" href="#cache-keys">Cache Keys</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../vendor/">External classes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../performance/">Performance</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../middlewares/">Middlewares</a>
        
    </li>

        
    </ul>

					<li>
					<li>
    <ul class="subnav">
    <li><span>Reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/http-exceptions/">default http exceptions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/sessions-table/">sessions table structure</a>
        
    </li>

        
    </ul>

					<li>
				</ul>
			</div>
			&nbsp;
		</nav>

		<section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

			
			<nav class="wy-nav-top" role="navigation" aria-label="top navigation">
				<i data-toggle="wy-nav-top" class="fa fa-bars"></i> <a
					href="../..">NoFussFramework Documentation</a>
			</nav>

			
			<div class="wy-nav-content">
				<div class="rst-content">
					<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Development &raquo;</li>
        
      
    
    <li>Cache</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/jarnix/nofussframework" class="icon icon-github"> Download on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
					<div role="main">
						<div class="section"> <h1 id="different-cache-systems">Different cache systems</h1>
<p>The framework allows you to use on or multiple cache systems. For example, you might want to use a "local" cache store for performance and another memcache store for all of your front servers that will share the data.</p>
<p>You have to declare them in the config.ini. </p>
<h2 id="memcached">Memcached</h2>
<p>Let's add a memcache cache handler in our application. Let's call it "global". This will be the name of the instance. </p>
<pre><code>cache.global.handler = memcached
cache.global.lifetime = 3600
cache.global.params.hosts = localhost
cache.global.params.port = 11211
</code></pre>

<p>The parameters for memcache are the ones that are read by the Nf\Cache\Memcached.php class.</p>
<p>Then in your code, you get this instance with a simple call:</p>
<pre><code>// use \Nf\Cache;
$globalCache = Cache::getStorage('global');
</code></pre>

<h2 id="apcapcu">apc/apcu</h2>
<p>The new name for the APC user cache is called "apcu".</p>
<p>If you want to use an instance of apcu, just add these lines in your config.ini:</p>
<p>Let's call this one "local" since it's local to the server.</p>
<pre><code>cache.local.handler = apc
cache.local.lifetime = 3600
</code></pre>

<p>This class does not accept any other parameters.</p>
<h1 id="common-parameters">Common parameters</h1>
<h2 id="keys-prefix">Keys prefix</h2>
<p>The Cache system allows you to add a prefix for all of your entries in the cache's storage. Just add this in the config.ini:</p>
<pre><code>cache.keyPrefix = myapp_
</code></pre>

<p>This value is optional and defaults to empty string.</p>
<h2 id="cache-keys">Cache Keys</h2>
<p>The Cache class uses keys and patterns instead of directly using strings.</p>
<p>The main advantage is that you will use the same keys everywhere in your application (preventing typos) and if you udpate your data model, you can easily clean the cache for the related keys by changing the pointer to the key's name and not the name directly. </p>
<p>Let's try with a basic example where we store an article and use the id of the article in the key's name.</p>
<pre><code>cachekeys.article = art[id]
</code></pre>

<p>Let's store something in this key:</p>
<pre><code>// use \Nf\Cache;
$globalCache = Cache::getStorage('global');
$globalCache-&gt;save('article', 47, [ 'text' =&gt; 'hello this is an interesting article about something' ] //, 3600); 
</code></pre>

<p>The parameters are :</p>
<ul>
<li>the name of the key defined in the config.ini (cachekeys.article)</li>
<li>the second parameter is replaced in the string defined in the config.ini, here we have only one parameter that is the id of the article so the framework replaces [id] with our id, here 47.</li>
<li>the data to store (it will be serialized internally by the php extension for this cache system)</li>
<li>an optional lifetime for this key (in seconds)</li>
</ul>
<p>Let's load this key from the store:</p>
<pre><code>// use \Nf\Cache;
$globalCache = Cache::getStorage('global');
$articleData = $globalCache-&gt;load('article', 47); 
</code></pre>

<h3 id="lifetime">Lifetime</h3>
<p>The lifetime can be set per key or per cache system. If you do not specify a lifetime, the framework will use the cache system's one, or the global value defined in the framework of 3600 seconds (one hour).</p>
<h3 id="multiple-key-identifiers">Multiple key identifiers</h3>
<p>You might have multiple identifiers for the key's name, like for storing pagination results for a matching tag. Your key will look like this in the config.ini:</p>
<pre><code>cachekeys.articleList = list_[tag]_[page]
</code></pre>

<p>In your code, you will use:</p>
<pre><code>$globalCache-&gt;save(
    'articleList',
    [ 'fashion', 2 ],
    [ 0 =&gt; 'first article...', 1 =&gt; 'second article...' ]
); 
</code></pre>

<p>The framework will replace the entries in the key's name in the order of the values, so:</p>
<ul>
<li>"fashion" will replace [tag]</li>
<li>2 will replace [page]</li>
</ul>
<p>You can also specify the name like this:</p>
<pre><code>$globalCache-&gt;save(
    'articleList',
    [ 'tag' =&gt; 'fashion', 'page' =&gt; 2 ],
    [ 0 =&gt; 'first article...', 1 =&gt; 'second article...' ]
); 
</code></pre>

<p>Or of course reorder them in the order you would like:</p>
<pre><code>$globalCache-&gt;save(
    'articleList',
    [ 'page' =&gt; 2, 'tag' =&gt; 'fashion' ],
    [ 0 =&gt; 'first article...', 1 =&gt; 'second article...' ]
); 
</code></pre>

<p>And the similar function to load the values from the store:</p>
<pre><code>$globalCache-&gt;load('articleList', [ 'page' =&gt; 2, 'tag' =&gt; 'fashion' ]); 
</code></pre>

<h3 id="deleting-values-from-the-store">Deleting values from the store</h3>
<pre><code>$globalCache-&gt;delete('articleList', [ 'page' =&gt; 2, 'tag' =&gt; 'fashion' ]); 
</code></pre> </div>
					</div> <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../vendor/" class="btn btn-neutral float-right" title="External classes"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../input-filtering/" class="btn btn-neutral" title="Input filtering"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a rel="nofollow" href="http://www.mkdocs.org">MkDocs</a> using a <a rel="nofollow" href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer> 
				</div>
			</div>

		</section>

	</div>

	<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/jarnix/nofussframework" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../input-filtering/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../vendor/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
